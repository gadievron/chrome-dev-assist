<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Fixture: Metadata at 1MB Limit</title>
</head>
<body data-test-id="metadata-1mb-limit" data-test-name="1MB Limit Test">
  <h1>Metadata Size Limit Test: At Limit (~1MB)</h1>
  <p>This page contains metadata close to but under the 1MB limit.</p>

  <script>
    // Create metadata that's approximately 1MB when serialized
    // Target: ~950KB to account for JSON overhead and stay under 1MB

    const targetSize = 950 * 1024; // 950KB of raw data
    const chunkSize = 10000; // Create chunks for readability
    const numChunks = Math.floor(targetSize / chunkSize);

    const largeData = [];
    for (let i = 0; i < numChunks; i++) {
      largeData.push({
        id: i,
        chunk: 'x'.repeat(chunkSize),
        metadata: {
          index: i,
          type: 'test-chunk',
          purpose: 'size-limit-validation'
        }
      });
    }

    window.testMetadata = {
      testId: 'metadata-1mb-limit',
      testPurpose: 'Validate 1MB size limit boundary',
      testType: 'edge-case',
      testCategory: 'size-validation',
      dataSize: targetSize,
      chunks: numChunks,
      largeData: largeData,
      description: 'This metadata should be accepted (close to but under 1MB limit)',
      timestamp: new Date().toISOString()
    };

    console.log('Test metadata created:', {
      chunks: numChunks,
      targetSize: targetSize,
      estimatedTotalSize: JSON.stringify(window.testMetadata).length
    });
  </script>
</body>
</html>
